<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원가입</title>
</head>
<body th:align="center">
<h1>회원가입</h1>
<form th:action="insertMember" method="post">
<table th:align="center" border="1" th:cellpadding="0" th:cellspacing="0">
	<tr>
		<td bgcolor="skyblue" th:text="아이디" width="80"></td>
		<td th:align="left"><input type="text" name="id" ></td>
	</tr>
	<tr>
		<td bgcolor="skyblue" th:text="비밀번호" width="50"></td>
		<td th:align="left"><input type="password" name="pwd"></td>
		<td th:align="left"><input type="password" name="re_pwd"></td>
		<td><input type="button" value="비밀번호 확인" onclick="checkPw()"/></td>
	</tr>
	<tr>
		<td bgcolor="skyblue" th:text="이름" width="50"></td>
		<td th:align="left"><input type="text" name="name"></td>
	</tr>
	<tr>
		<td bgcolor="skyblue" th:text="닉네임" width="50"></td>
		<td th:align="left"><input type="text" name="nick_name" ></td>
	</tr>
	<tr>
		<td bgcolor="skyblue" th:text="성별" width="50"></td>
		<td th:align="left">
			<label><input type="radio" name="gender" value="F" checked>여성</label>	
			<label><input type="radio" name="gender" value="M">남성</label>	
		</td>
	</tr>	
	<tr>
		<td bgcolor="skyblue" th:text="이메일" width="50"></td>
		<td th:align="left">
			<input type="email" name="email">
		</td>
	</tr>
	<tr>
		<td bgcolor="skyblue" th:text="전화번호" width="50"></td>
		<td th:align="left"><input type="text" name="phone" ></td>
	</tr>
	<tr>
		<td bgcolor="skyblue" th:text="주소" width="50"></td>
		<td th:align="left"><input type="text" name="address" id="address_kakao"></td>
		<!-- <td><input type="text" name="address" id="address_detail"></td> -->
	</tr>
</table>
	<input type="submit" value="회원가입" id="checkPw()"/>
	<input type="button" value="뒤로가기" onclick="location.href='login'"/>
</form>
</body>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
window.onload = function(){
    document.getElementById("address_kakao").addEventListener("click", function(){ //주소입력칸을 클릭하면
        //카카오 지도 발생
        new daum.Postcode({
            oncomplete: function(data) { //선택시 입력값 세팅
                document.getElementById("address_kakao").value = data.address; // 주소 넣기
                document.querySelector("input[name=address_detail]").focus(); //상세입력 포커싱
            }
        }).open();
    });
}

function checkPw(){

    let id = $("#id").val();
    let pw = $("#pwd").val();
    let number = pw.search(/[0-9]/g);
    let english = pw.search(/[a-z]/ig);
    let spece = pw.search(/[`~!@@#$%^&*|₩₩₩'₩";:₩/?]/gi);
    let reg = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;

    if (pw.length < 8 || pw.length > 20) {
        alert("8자리 ~ 20자리 이내로 입력해주세요.");
        return false;

    } else if (pw.search(/\s/) != -1) {
        alert("비밀번호는 공백 없이 입력해주세요.");
        return false;

    } else if (number < 0 || english < 0 || spece < 0) {
        alert("영문,숫자,특수문자를 혼합하여 입력해주세요.");
        return false;

    } else if ((number < 0 && english < 0) || (english < 0 && spece < 0) || (spece < 0 && number < 0)) {
        alert("영문,숫자, 특수문자 중 2가지 이상을 혼합하여 입력해주세요.");
        return false;

    } else if (/(\w)\1\1\1/.test(pw)) {
        alert('같은 문자를 4번 이상 사용하실 수 없습니다.');
        return false;

    } else if (pw.search(id) > -1) {
        alert("비밀번호에 아이디가 포함되었습니다.");
        return false;
    } else {
        alert("비밀번호가 정상적으로 입력되었습니다.");
        return true;
    }

    if (false === reg.test(pw)) {
        alert('비밀번호는 8자 이상이어야 하며, 숫자/대문자/소문자/특수문자를 모두 포함해야 합니다.');
        return false;
    } else {
        alert("비밀번호가 정상적으로 입력되었습니다.");
        return true;
    }
}

</script>
</html>